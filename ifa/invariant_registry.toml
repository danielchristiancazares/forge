version = 1
last_updated = "2026-02-19"

[[invariants]]
id = "APP-INV-1"
predicate = "Exactly one operation lifecycle state exists at a time."
canonical_proof_type_path = "engine::state::OperationState"
authority_boundary_module_path = "engine::app::mod"

[[invariants]]
id = "APP-INV-2"
predicate = "Tool execution is allowed only when tool gate state permits execution."
canonical_proof_type_path = "engine::app::tool_gate::ToolGate"
authority_boundary_module_path = "engine::app::tool_gate"

[[invariants]]
id = "APP-INV-3"
predicate = "Tool loop ingress carries explicit tool journal batch presence via sum type."
canonical_proof_type_path = "engine::state::ToolJournalBatch"
authority_boundary_module_path = "engine::state"

[[invariants]]
id = "APP-INV-4"
predicate = "Tool loop payload carries canonical thinking shape without optional payload fields."
canonical_proof_type_path = "core::thinking::ThinkingPayload"
authority_boundary_module_path = "core::thinking"

[[invariants]]
id = "APP-INV-5"
predicate = "Active stream typestate transitions from transient to journaled only through consuming transition."
canonical_proof_type_path = "engine::state::ActiveStream"
authority_boundary_module_path = "engine::state"

[[invariants]]
id = "APP-INV-6"
predicate = "User-facing message content is non-empty after normalization."
canonical_proof_type_path = "types::proofs::NonEmptyString"
authority_boundary_module_path = "types::proofs"

[[invariants]]
id = "APP-INV-7"
predicate = "Persisted content contains no standalone carriage returns."
canonical_proof_type_path = "types::proofs::PersistableContent"
authority_boundary_module_path = "types::proofs"

[[invariants]]
id = "APP-INV-8"
predicate = "Stream and tool journal crash-recovery identities are explicit typed IDs."
canonical_proof_type_path = "types::ToolBatchId"
authority_boundary_module_path = "context::tool_journal"

[[invariants]]
id = "APP-INV-10"
predicate = "Provider request/response model name selection is represented by strongly typed model names."
canonical_proof_type_path = "types::model::ModelName"
authority_boundary_module_path = "types::model"

[[invariants]]
id = "APP-INV-11"
predicate = "A plan is a valid DAG with non-empty phases and valid monotonically assigned step IDs."
canonical_proof_type_path = "types::plan::Plan"
authority_boundary_module_path = "types::plan"

[[invariants]]
id = "APP-INV-12"
predicate = "A plan has reached a terminal satisfied state across all phases and steps."
canonical_proof_type_path = "types::plan::CompletedPlan"
authority_boundary_module_path = "types::plan"

[[invariants]]
id = "APP-INV-13"
predicate = "Provider SSE payload decode outcome is explicit and never encoded as optional absence."
canonical_proof_type_path = "providers::ParsedSsePayload"
authority_boundary_module_path = "providers"

[[invariants]]
id = "APP-INV-14"
predicate = "Settings modal filter interaction lifecycle is represented as an explicit mode enum."
canonical_proof_type_path = "types::ui::input::SettingsFilterMode"
authority_boundary_module_path = "engine::app::mod"

[[invariants]]
id = "APP-INV-15"
predicate = "Transcript redraw behavior is represented as explicit render action state."
canonical_proof_type_path = "types::ui::view_state::TranscriptRenderAction"
authority_boundary_module_path = "engine::app::commands"

[[invariants]]
id = "APP-INV-16"
predicate = "File picker index readiness is encoded as explicit scan-state lifecycle."
canonical_proof_type_path = "engine::ui::file_picker::FileScanState"
authority_boundary_module_path = "engine::ui::file_picker"
